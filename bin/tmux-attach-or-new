#!/usr/bin/env zsh
# must be zsh as zshenv uses zsh's built-in path array

# Attach to an existing detached session.
# If none exist, create a new session.

if [ -f "$HOME/.zshenv" ]; then
  source "$HOME/.zshenv"
fi

detached=$(tmux list-sessions -F '#{session_name}:#{session_attached}' 2>/dev/null | awk -F: '$2 == 0 {print $1}')

if [[ -n "$detached" ]]; then
	tmux attach-session -t "$(echo "$detached" | head -n 1)"
else
	tmux new-session
fi
