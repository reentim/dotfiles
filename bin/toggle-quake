#!/usr/bin/env bash

kitty="kitty \
  --override shell=zsh \
  --config "$HOME"/.config/kitty/kitty.conf \
  --config "$HOME"/.config/kitty/themes/modus_vivendi.conf \
  --config "$HOME"/.config/kitty/quake.conf \
  --class quake \
  tmux -L quake new-session -As \`"

active_ws=$(hyprctl activeworkspace -j | jq '.id')

quake_is_active=$(
  hyprctl clients -j | jq -e \
    --argjson ws "$active_ws" \
    '.[] | select(.workspace.id == $ws) | select(.class == "quake")'
)

if [[ $quake_is_active ]]; then
  tmux -L quake detach-client -s '\`'
else
  $kitty
fi
