#!/usr/bin/env bash

session_name="-"
kitty="kitty \
  --override shell=zsh \
  --config "$HOME"/.config/kitty/kitty.conf \
  --config "$HOME"/.config/kitty/themes/modus_vivendi.conf \
  --config "$HOME"/.config/kitty/quake.conf \
  --class quake \
  tmux new-session -As "$session_name""

active_ws=$(hyprctl activeworkspace -j | jq '.id')

quake_is_active=$(
  hyprctl clients -j | jq -e \
    --argjson ws "$active_ws" \
    '.[] | select(.workspace.id == $ws) | select(.class == "quake")'
)

if [[ $quake_is_active ]]; then
  tmux detach-client -s "$session_name"
else
  $kitty
fi
