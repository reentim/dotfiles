#!/usr/bin/env bash

session_name="-"
kitty="kitty \
  --override shell=zsh \
  --config "$HOME"/.config/kitty/kitty.conf \
  --config "$HOME"/.config/kitty/themes/modus_vivendi.conf \
  --class quake \
  tmux new-session -As "$session_name""


active_ws=$(hyprctl activeworkspace -j | jq '.id')

active_ws_window_classes=$(
  hyprctl clients -j | jq -r \
    --argjson ws "$active_ws" \
    '.[] | select(.workspace.id == $ws) | .class'
)

if echo $active_ws_window_classes | grep -qw "quake"; then
  tmux detach-client -s "$session_name"
else
  $kitty
fi
