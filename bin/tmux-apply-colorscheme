#!/usr/bin/env -S ruby --disable-gems

def main(name)
  name = name || %x[current-profile]
  dir = File.join(Dir.home, "/.tmux/colorschemes")
  files = Dir.glob(File.join(dir, "/*"))
  presumed_file = name.downcase
      .gsub("\s", "_")
      .gsub("-", "_")
      .chomp + ".conf"

  found_file = files.find { |file|
    File.basename(file) == presumed_file
  }

  if found_file
    %x[tmux source-file #{found_file}]
  end
end

main ARGV[0]
