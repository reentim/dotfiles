#!/bin/bash

set -e

unwip() {
  if [ "`git log --format=%B -n 1 HEAD`" = "wip" ]; then
    git reset --soft HEAD~1;
    git reset HEAD;
  fi;
}

recent_branch() {
  echo "
    puts '`git reflog -n 100 | grep 'checkout: moving'`'.lines.
      map { |l| l.strip.split('to ').last }.uniq & '`git branch`'.lines.
      map { |l| l.strip }
  " | ruby |
      selecta |
      xargs git checkout
}

branch_diff() {
  branch=$1
  git diff $(git merge-base --fork-point origin/staging $branch)..$branch
}
